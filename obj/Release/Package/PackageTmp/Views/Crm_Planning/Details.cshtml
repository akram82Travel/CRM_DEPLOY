@model CRMSTUBSOFT.Crm_Planning

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var ListeDay = ViewData["DayListe"] as IEnumerable<CRMSTUBSOFT.Crm_PlanningTime>;
    var ListOBJ = ViewData["ListeOBJ"] as List<string>;
    int i = 0;
    int z = 0;// compteur date
    int l = 0;//compteur text par resp par date
    int mr = 0;//compteur text par resp par date
    int mc = 0;//compteur text par resp par date
    int jd = 0;//compteur text par resp par date
    int vn = 0;//compteur text par resp par date
    int sm = 0;//compteur text par resp par date

    string textObjMatin = "";
    string textObjAmidi = "";
    string textReelMatin = "";
    string textReelAmidi = "";
}

<div class="content-wrapper">
    <div class="content-header">
        <div class="content-header-left col-md-12 col-12 mb-2 breadcrumb-new card">
            <div class="row no-gutters">
                <div class="col-md-3"><span style="padding-top: 9px; font-size: 16px; " class="content-header-title mb-0 d-inline-block"> Détails des Plans</span></div>
                <div class="col-md-4" style=" padding-top: 8px;">
                    <div class="row breadcrumbs-top d-inline-block">
                        <div class="breadcrumb-wrapper">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a href="/">Tableau de Bord</a>
                                </li>
                                <li class="breadcrumb-item">
                                    <a href="/Crm_Planning">Planning</a>
                                </li>
                                <li class="breadcrumb-item active">
                                    Détails des Plans
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

            </div>


        </div>

    </div>


    <div class="card">
        <div class="card-content">
            <div class="card-body">
                <div class="pull-right">

                    <input type="button" value="Imprimer" class="btn btn-success" onclick="imprimer()" />

                </div>
                <br /> <br /> <br />
                              <div id="SelectorToPrint" name="SelectorToPrint" class="table-responsive">
                                  <link href="~/Content/css/bootstrap-extended.min.css" rel="stylesheet">
                                  <style type="text/css" media="print">
                                      .page {
                                          -webkit-transform: rotate(-90deg);
                                          -moz-transform: rotate(-90deg);
                                          filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
                                      }
                                  </style>

                                
                                  <div class="card">
                                      <div class="bg-white">
                                          <div class="card-header text-center" style="text-align: center">
                                              <h1>Plan de la semaine Responsable :<b>@Model.CodeResponsable</b> </h1>
                                              <p>
                                                  DU: @Model.Datedebut.ToString().Replace(" 00:00:00", "") | Au : @Model.DateFin.ToString().Replace(" 00:00:00", "")
                                              </p>
                                          </div>
                                         
                                          <table style="width:100%; font-size:10px" class=" table-striped table-bordered">
                                              <thead>
                                                  <tr>
                                                      <th>
                                                          Responsable/Date
                                                      </th>

                                                      @foreach (var item in ListeDay)
                                                      {
                                                          if (i < 6)
                                                          {
                                                              <th>
                                                                  @item.Date.ToString().Replace(" 00:00:00", "")
                                                              </th>
                                                          }

                                                          i++;
                                                      }

                                                  </tr>
                                              </thead>
                                              <tbody>
                                                  @foreach (var item in ViewData["ListeRsp"] as List<string>)
                                                  {
                                                      var responsable = item;

                                                      <tr>
                                                          <td id="col1">

                                                              <label style="font-weight: bold; font-size:13px">
                                                                  @responsable
                                                              </label><br />
                                                              <label style="font-weight: bold; font-size: 10px ">
                                                                  Objectifs non réalisés
                                                              </label><br />

                                                              @if (ListOBJ.Count() > 0)
                                                              {

                                                                  if (z < ListOBJ.Count())
                                                                  {
                                                                      @ListOBJ.ElementAt(z)
                                                                  }

                                                              }
                                                          </td>
                                                          <td>
                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 0)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;


                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;


                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;


                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;



                                                                              }
                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                                  textObjMatin = "";
                                                                  textObjMatin = "";
                                                                  textObjAmidi = "";
                                                                  textReelAmidi = "";
                                                              }
                                                          </td>
                                                          <td>

                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 1)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;

                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;

                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;

                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;

                                                                              }

                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                                  textObjMatin = "";
                                                                  textObjMatin = "";
                                                                  textObjAmidi = "";
                                                                  textReelAmidi = "";
                                                              }
                                                          </td>
                                                          <td>
                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 2)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;

                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;

                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;

                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;


                                                                              }
                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                                  textObjMatin = "";
                                                                  textObjMatin = "";
                                                                  textObjAmidi = "";
                                                                  textReelAmidi = "";
                                                              }
                                                          </td>
                                                          <td>
                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 3)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;
                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;

                                                                              }
                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                                  textObjMatin = "";
                                                                  textObjMatin = "";
                                                                  textObjAmidi = "";
                                                                  textReelAmidi = "";
                                                              }
                                                          </td>
                                                          <td>
                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 4)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;
                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;

                                                                              }
                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                                  textObjMatin = "";
                                                                  textObjMatin = "";
                                                                  textObjAmidi = "";
                                                                  textReelAmidi = "";
                                                              }
                                                          </td>
                                                          <td>
                                                              @{
                                                                  l = 0;
                                                              }
                                                              @foreach (var item1 in ListeDay)
                                                              {

                                                                  if (item1.CodeResponsable == responsable)
                                                                  {
                                                                      //@item1.Titre
                                                                      //@l
                                                                      if (l == 5)
                                                                      {
                                                                          if (@item1.Matin != null)
                                                                          {
                                                                              if (@item1.Matin != "")
                                                                              {
                                                                                  textObjMatin = item1.Matin;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidi != null)
                                                                          {
                                                                              if (@item1.ApresMidi != "")
                                                                              {
                                                                                  textObjAmidi = item1.ApresMidi;
                                                                              }
                                                                          }
                                                                          if (@item1.MatinReel != null)
                                                                          {
                                                                              if (@item1.MatinReel != "")
                                                                              {
                                                                                  textReelMatin = item1.MatinReel;
                                                                              }
                                                                          }
                                                                          if (@item1.ApresMidiReel != null)
                                                                          {
                                                                              if (@item1.ApresMidiReel != "")
                                                                              {
                                                                                  textReelAmidi = item1.ApresMidiReel;
                                                                              }
                                                                          }

                                                                      }
                                                                      l++;
                                                                  }

                                                              }
                                                              <table style="width:100%; font-size:10px">
                                                                  <tr>
                                                                      <th></th>
                                                                      <th>Objectif</th>
                                                                      <th>Réel</th>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Matin</td>
                                                                      <td>@textObjMatin</td>
                                                                      <td>@textReelMatin</td>
                                                                  </tr>
                                                                  <tr>
                                                                      <td>Apres midi</td>
                                                                      <td>@textObjAmidi</td>
                                                                      <td>@textReelAmidi</td>
                                                                  </tr>
                                                              </table>
                                                              @{
                                                          textObjMatin = "";
                                                          textObjMatin = "";
                                                          textObjAmidi = "";
                                                          textReelAmidi = "";
                                                              }

                                                          </td>
                                                      </tr>
                                                      z++;
                                                  }
                                              </tbody>
                                          </table>
                                      </div>

                                  </div>



                              </div>
            </div>
        </div>
    </div>


</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
    function imprimer()
    {

    var divElementContents = document.getElementById("SelectorToPrint").innerHTML;

 	var windows = window.open();
 	windows.document.write(divElementContents);


 	windows.document.close();
 	windows.print();

    }

$(function() {
    $("a#print").click(imprimer);
});
    </script>

}